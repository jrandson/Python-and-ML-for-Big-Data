{"version":"NotebookV1","origId":2026237795572388,"name":"Fundamentals Decisions tree","language":"python","commands":[{"version":"CommandV1","origId":2026237795572389,"guid":"c13fd74f-3a5f-4579-ae26-5a81fc560761","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql import SparkSession\nspark = SparkSession.builder.appName(\"Decision Tree\").getOrCreate()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;Builder&apos; object has no attribute &apos;getOrcreate&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2026237795572389&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql <span class=\"ansigreen\">import</span> SparkSession<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>spark <span class=\"ansiyellow\">=</span> SparkSession<span class=\"ansiyellow\">.</span>builder<span class=\"ansiyellow\">.</span>appName<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Decision Tree&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>getOrcreate<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;Builder&apos; object has no attribute &apos;getOrcreate&apos;</div>","workflows":[],"startTime":1516147585247,"submitTime":1516147585235,"finishTime":1516147585323,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"051b0286-bef3-483d-9bd9-dc3a75363e49"},{"version":"CommandV1","origId":2026237795572391,"guid":"99f858c5-8e31-4a71-9cf1-3dafdd07592e","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.ml import pipeline\nfrom pyspark.ml.classification import (RandomForestClassifier, GBTClassifier, DecisionTreeClassifier)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">ImportError</span>: cannot import name DesisionTreeClassifier","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ImportError</span>                               Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2026237795572391&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>ml <span class=\"ansigreen\">import</span> pipeline<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>ml<span class=\"ansiyellow\">.</span>classification <span class=\"ansigreen\">import</span> <span class=\"ansiyellow\">(</span>RandomForestClassifier<span class=\"ansiyellow\">,</span> GBTClassifier<span class=\"ansiyellow\">,</span> DesisionTreeClassifier<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ImportError</span>: cannot import name DesisionTreeClassifier</div>","workflows":[],"startTime":1516147599456,"submitTime":1516147599443,"finishTime":1516147599533,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"115f2c5c-e7e5-4d8e-8d2b-1a13eb826708"},{"version":"CommandV1","origId":2026237795572392,"guid":"5ef0d492-4f87-44ca-acdd-ec7cf7541ce2","subtype":"command","commandType":"auto","position":3.0,"command":"data = spark.read.format('libsvm').load('/FileStore/tables/sample_libsvm_data.txt')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;command-2026237795572392&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    from pyspark.ml.regression import</span>\n<span class=\"ansigrey\">                                      ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1516147663121,"submitTime":1516147663108,"finishTime":1516147665082,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"53cda55d-7706-4842-87c5-b5fae0288cc4"},{"version":"CommandV1","origId":2026237795572395,"guid":"84478a51-6c1f-4868-99d7-7e5a0737ce79","subtype":"command","commandType":"auto","position":4.0,"command":"data.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+\n|label|            features|\n+-----+--------------------+\n|  0.0|(692,[127,128,129...|\n|  1.0|(692,[158,159,160...|\n|  1.0|(692,[124,125,126...|\n|  1.0|(692,[152,153,154...|\n|  1.0|(692,[151,152,153...|\n|  0.0|(692,[129,130,131...|\n|  1.0|(692,[158,159,160...|\n|  1.0|(692,[99,100,101,...|\n|  0.0|(692,[154,155,156...|\n|  0.0|(692,[127,128,129...|\n|  1.0|(692,[154,155,156...|\n|  0.0|(692,[153,154,155...|\n|  0.0|(692,[151,152,153...|\n|  1.0|(692,[129,130,131...|\n|  0.0|(692,[154,155,156...|\n|  1.0|(692,[150,151,152...|\n|  0.0|(692,[124,125,126...|\n|  0.0|(692,[152,153,154...|\n|  1.0|(692,[97,98,99,12...|\n|  1.0|(692,[124,125,126...|\n+-----+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516147668399,"submitTime":1516147668382,"finishTime":1516147669278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5709061b-4611-4009-ac73-183de01e3a37"},{"version":"CommandV1","origId":2026237795572396,"guid":"ce3da91d-38ff-4fab-9d4d-d28c25199f97","subtype":"command","commandType":"auto","position":5.0,"command":"dtc = DecisionTreeClassifier()\nrfc = RandomForestClassifier(numTrees=100)\ngbt = GBTClassifier()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516148526794,"submitTime":1516148526782,"finishTime":1516148526867,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ce42dde1-6cb7-4d05-b712-18ec9546b0b9"},{"version":"CommandV1","origId":2026237795572397,"guid":"8e7619e8-ea55-4ff1-ac22-e751fc155b2f","subtype":"command","commandType":"auto","position":4.5,"command":"train_data, test_date = data.randomSplit([0.7, 0.3])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"test_date","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516147871606,"submitTime":1516147871596,"finishTime":1516147871733,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4e93e4a9-ba12-4fce-a34d-93d00881be42"},{"version":"CommandV1","origId":2026237795572398,"guid":"7c5074f6-ec26-488a-a07d-bd63deb59982","subtype":"command","commandType":"auto","position":6.0,"command":"dtc_model = dtc.fit(train_data)\nrfc_model = rfc.fit(train_data)\ngbt_model = gbt.fit(train_data)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516148527317,"submitTime":1516148527305,"finishTime":1516148544838,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ba60dfa6-337b-4de8-8895-9bb959b8452f"},{"version":"CommandV1","origId":2026237795572399,"guid":"799c9666-7a15-492f-ab9d-7edbbad83c04","subtype":"command","commandType":"auto","position":7.0,"command":"dtc_preds = dtc_model.transform(test_date)\nrfc_preds = rfc_model.transform(test_date)\ngbt_preds = gbt_model.transform(test_date)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"dtc_preds","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"rfc_preds","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"gbt_preds","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516148544846,"submitTime":1516148528001,"finishTime":1516148545033,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a91900fa-1346-4f1f-bd5e-35840cd4ea56"},{"version":"CommandV1","origId":2026237795572400,"guid":"b94aff42-62c8-4b17-bf07-cdc817905b70","subtype":"command","commandType":"auto","position":8.0,"command":"rfc_preds.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+-------------+-----------+----------+\n|label|            features|rawPrediction|probability|prediction|\n+-----+--------------------+-------------+-----------+----------+\n|  0.0|(692,[98,99,100,1...|  [100.0,0.0]|  [1.0,0.0]|       0.0|\n|  0.0|(692,[122,123,124...|  [100.0,0.0]|  [1.0,0.0]|       0.0|\n|  0.0|(692,[123,124,125...|  [100.0,0.0]|  [1.0,0.0]|       0.0|\n|  0.0|(692,[123,124,125...|  [100.0,0.0]|  [1.0,0.0]|       0.0|\n|  0.0|(692,[124,125,126...|   [98.0,2.0]|[0.98,0.02]|       0.0|\n|  0.0|(692,[124,125,126...|  [100.0,0.0]|  [1.0,0.0]|       0.0|\n|  0.0|(692,[126,127,128...|  [100.0,0.0]|  [1.0,0.0]|       0.0|\n|  0.0|(692,[129,130,131...|   [93.0,7.0]|[0.93,0.07]|       0.0|\n|  0.0|(692,[150,151,152...|   [95.0,5.0]|[0.95,0.05]|       0.0|\n|  0.0|(692,[151,152,153...|  [100.0,0.0]|  [1.0,0.0]|       0.0|\n|  0.0|(692,[152,153,154...|   [91.0,9.0]|[0.91,0.09]|       0.0|\n|  0.0|(692,[154,155,156...|  [83.0,17.0]|[0.83,0.17]|       0.0|\n|  0.0|(692,[181,182,183...|  [86.0,14.0]|[0.86,0.14]|       0.0|\n|  1.0|(692,[99,100,101,...|  [54.0,46.0]|[0.54,0.46]|       0.0|\n|  1.0|(692,[123,124,125...|   [1.0,99.0]|[0.01,0.99]|       1.0|\n|  1.0|(692,[125,126,153...|  [0.0,100.0]|  [0.0,1.0]|       1.0|\n|  1.0|(692,[126,127,128...|  [0.0,100.0]|  [0.0,1.0]|       1.0|\n|  1.0|(692,[127,128,129...|  [0.0,100.0]|  [0.0,1.0]|       1.0|\n|  1.0|(692,[127,128,129...|  [0.0,100.0]|  [0.0,1.0]|       1.0|\n|  1.0|(692,[127,128,154...|  [0.0,100.0]|  [0.0,1.0]|       1.0|\n+-----+--------------------+-------------+-----------+----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;RandomForestClassificationModel&apos; object has no attribute &apos;show&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2026237795572400&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>rfc_model<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;RandomForestClassificationModel&apos; object has no attribute &apos;show&apos;</div>","workflows":[],"startTime":1516148545040,"submitTime":1516148528596,"finishTime":1516148545565,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b6f6d287-c6b0-44a8-99eb-a4c0e6b13e13"},{"version":"CommandV1","origId":2026237795572401,"guid":"5409ceff-c86d-40e6-8b74-1d67b4d87a80","subtype":"command","commandType":"auto","position":9.0,"command":"from pyspark.ml.evaluation import MulticlassClassificationEvaluator","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516148545572,"submitTime":1516148529190,"finishTime":1516148545646,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1ee20ce-814d-4e72-be8e-5963f01bff5d"},{"version":"CommandV1","origId":2026237795572402,"guid":"b2b2a376-b71a-4b69-b0b9-4b4ba030211e","subtype":"command","commandType":"auto","position":10.0,"command":"acc_eval = MulticlassClassificationEvaluator(metricName='accuracy')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516148545656,"submitTime":1516148529980,"finishTime":1516148545699,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"18ac76bb-00d7-4395-a4e6-c87b6a43a66f"},{"version":"CommandV1","origId":2026237795572403,"guid":"20ae98e2-8622-451b-9b9c-285d72115f88","subtype":"command","commandType":"auto","position":11.0,"command":"print 'DTC ACCURACY:', acc_eval.evaluate(dtc_preds)\nprint 'RFC ACCURACY:', acc_eval.evaluate(rfc_preds)\nprint 'GBT ACCURACY:', acc_eval.evaluate(gbt_preds)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DTC ACCURACY: 0.928571428571\nRFC ACCURACY: 0.964285714286\nGBT ACCURACY: 0.928571428571\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;gbt_preds_preds&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2026237795572403&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;DTC ACCURACY:&apos;</span><span class=\"ansiyellow\">,</span> acc_eval<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>dtc_preds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;RFC ACCURACY:&apos;</span><span class=\"ansiyellow\">,</span> acc_eval<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>rfc_preds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;GBT ACCURACY:&apos;</span><span class=\"ansiyellow\">,</span> acc_eval<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>gbt_preds_preds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;gbt_preds_preds&apos; is not defined</div>","workflows":[],"startTime":1516148545705,"submitTime":1516148530568,"finishTime":1516148546815,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0fa1dccb-535f-47a6-8815-7fddd3c8ee74"},{"version":"CommandV1","origId":2026237795572404,"guid":"d426ea1b-5565-43d5-a197-dfb7e9e5c7da","subtype":"command","commandType":"auto","position":12.0,"command":"rfc_model.featureImportances","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>SparseVector(692, {120: 0.0005, 176: 0.0006, 181: 0.0002, 205: 0.0002, 207: 0.0017, 213: 0.0015, 231: 0.0025, 243: 0.0123, 244: 0.0103, 245: 0.0113, 263: 0.0143, 267: 0.0018, 271: 0.0015, 272: 0.0018, 273: 0.0158, 287: 0.002, 289: 0.0077, 291: 0.0005, 292: 0.0008, 299: 0.0086, 300: 0.0186, 301: 0.0016, 302: 0.0045, 313: 0.0005, 317: 0.0077, 322: 0.0002, 323: 0.0003, 324: 0.0002, 328: 0.0086, 330: 0.0062, 331: 0.0062, 332: 0.0017, 345: 0.0141, 346: 0.0062, 350: 0.0211, 351: 0.0261, 353: 0.0005, 354: 0.0002, 356: 0.0076, 357: 0.0151, 373: 0.0181, 374: 0.0051, 375: 0.0011, 377: 0.017, 378: 0.0424, 379: 0.0015, 380: 0.0004, 385: 0.0078, 386: 0.005, 387: 0.0018, 401: 0.0013, 405: 0.0123, 406: 0.0457, 407: 0.0048, 426: 0.0058, 427: 0.0057, 428: 0.007, 429: 0.0191, 430: 0.0021, 432: 0.0063, 433: 0.0326, 434: 0.0471, 436: 0.0012, 438: 0.0016, 442: 0.0062, 454: 0.0038, 455: 0.0388, 456: 0.0134, 457: 0.0028, 461: 0.0201, 462: 0.0325, 463: 0.0086, 470: 0.0052, 471: 0.0003, 483: 0.0007, 484: 0.0096, 488: 0.0052, 489: 0.0142, 490: 0.0702, 493: 0.0031, 495: 0.0003, 496: 0.0004, 499: 0.0033, 511: 0.0348, 512: 0.0368, 517: 0.0457, 522: 0.0009, 523: 0.0084, 525: 0.0028, 538: 0.0031, 539: 0.0239, 540: 0.029, 544: 0.0004, 545: 0.0073, 549: 0.0005, 550: 0.0077, 555: 0.0019, 566: 0.0064, 568: 0.0079, 571: 0.0004, 601: 0.0002, 602: 0.001, 606: 0.0004, 609: 0.0024, 621: 0.0006, 629: 0.0007, 630: 0.0015, 632: 0.0002, 654: 0.0003, 658: 0.0003, 662: 0.0006})\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1516148573702,"submitTime":1516148573689,"finishTime":1516148573775,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3c9f810b-130c-48c9-bbc3-8bb1b0c553ef"},{"version":"CommandV1","origId":2026237795572405,"guid":"1f84782a-7692-4579-aab9-6b63fef8b3b1","subtype":"command","commandType":"auto","position":13.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f0cb2a19-ae6d-43ae-a26e-3c51083acef0"}],"dashboards":[],"guid":"632bcd45-224a-438f-a16e-6f3ecbc95a14","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}