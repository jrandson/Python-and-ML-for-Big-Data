{"version":"NotebookV1","origId":2042983320593129,"name":"Radom forest","language":"python","commands":[{"version":"CommandV1","origId":2042983320593130,"guid":"87751ac4-0310-4608-a561-0189f203ddfb","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql import SparkSession","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766690036,"submitTime":1518766690016,"finishTime":1518766690113,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8bab30b-593c-4875-a24d-d2527bb463cb"},{"version":"CommandV1","origId":2042983320593134,"guid":"93890cdc-ca71-4dee-bd58-bf94f9b9ad3b","subtype":"command","commandType":"auto","position":2.0,"command":"spark = SparkSession.builder.appName('tree').getOrCreate()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766692069,"submitTime":1518766692048,"finishTime":1518766692114,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0c884e0f-c380-4c41-82ea-8b9a7883749d"},{"version":"CommandV1","origId":2042983320593135,"guid":"3c7e6322-0760-4677-890c-dae05467ac38","subtype":"command","commandType":"auto","position":3.0,"command":"data = spark.read.csv('/FileStore/tables/College.csv', inferSchema=True, header=True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"School","nullable":true,"type":"string"},{"metadata":{},"name":"Private","nullable":true,"type":"string"},{"metadata":{},"name":"Apps","nullable":true,"type":"integer"},{"metadata":{},"name":"Accept","nullable":true,"type":"integer"},{"metadata":{},"name":"Enroll","nullable":true,"type":"integer"},{"metadata":{},"name":"Top10perc","nullable":true,"type":"integer"},{"metadata":{},"name":"Top25perc","nullable":true,"type":"integer"},{"metadata":{},"name":"F_Undergrad","nullable":true,"type":"integer"},{"metadata":{},"name":"P_Undergrad","nullable":true,"type":"integer"},{"metadata":{},"name":"Outstate","nullable":true,"type":"integer"},{"metadata":{},"name":"Room_Board","nullable":true,"type":"integer"},{"metadata":{},"name":"Books","nullable":true,"type":"integer"},{"metadata":{},"name":"Personal","nullable":true,"type":"integer"},{"metadata":{},"name":"PhD","nullable":true,"type":"integer"},{"metadata":{},"name":"Terminal","nullable":true,"type":"integer"},{"metadata":{},"name":"S_F_Ratio","nullable":true,"type":"double"},{"metadata":{},"name":"perc_alumni","nullable":true,"type":"integer"},{"metadata":{},"name":"Expend","nullable":true,"type":"integer"},{"metadata":{},"name":"Grad_Rate","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;inferSchema&apos; is not defined","error":null,"workflows":[],"startTime":1518766693677,"submitTime":1518766693658,"finishTime":1518766698553,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4ab19e63-c234-4a05-9148-e44b3a9795db"},{"version":"CommandV1","origId":2042983320593136,"guid":"d439c84f-f81c-4d0c-99c6-6f62303c8508","subtype":"command","commandType":"auto","position":4.0,"command":"data.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+-------+----+------+------+---------+---------+-----------+-----------+--------+----------+-----+--------+---+--------+---------+-----------+------+---------+\n|              School|Private|Apps|Accept|Enroll|Top10perc|Top25perc|F_Undergrad|P_Undergrad|Outstate|Room_Board|Books|Personal|PhD|Terminal|S_F_Ratio|perc_alumni|Expend|Grad_Rate|\n+--------------------+-------+----+------+------+---------+---------+-----------+-----------+--------+----------+-----+--------+---+--------+---------+-----------+------+---------+\n|Abilene Christian...|    Yes|1660|  1232|   721|       23|       52|       2885|        537|    7440|      3300|  450|    2200| 70|      78|     18.1|         12|  7041|       60|\n|  Adelphi University|    Yes|2186|  1924|   512|       16|       29|       2683|       1227|   12280|      6450|  750|    1500| 29|      30|     12.2|         16| 10527|       56|\n|      Adrian College|    Yes|1428|  1097|   336|       22|       50|       1036|         99|   11250|      3750|  400|    1165| 53|      66|     12.9|         30|  8735|       54|\n| Agnes Scott College|    Yes| 417|   349|   137|       60|       89|        510|         63|   12960|      5450|  450|     875| 92|      97|      7.7|         37| 19016|       59|\n|Alaska Pacific Un...|    Yes| 193|   146|    55|       16|       44|        249|        869|    7560|      4120|  800|    1500| 76|      72|     11.9|          2| 10922|       15|\n|   Albertson College|    Yes| 587|   479|   158|       38|       62|        678|         41|   13500|      3335|  500|     675| 67|      73|      9.4|         11|  9727|       55|\n|Albertus Magnus C...|    Yes| 353|   340|   103|       17|       45|        416|        230|   13290|      5720|  500|    1500| 90|      93|     11.5|         26|  8861|       63|\n|      Albion College|    Yes|1899|  1720|   489|       37|       68|       1594|         32|   13868|      4826|  450|     850| 89|     100|     13.7|         37| 11487|       73|\n|    Albright College|    Yes|1038|   839|   227|       30|       63|        973|        306|   15595|      4400|  300|     500| 79|      84|     11.3|         23| 11644|       80|\n|Alderson-Broaddus...|    Yes| 582|   498|   172|       21|       44|        799|         78|   10468|      3380|  660|    1800| 40|      41|     11.5|         15|  8991|       52|\n|   Alfred University|    Yes|1732|  1425|   472|       37|       75|       1830|        110|   16548|      5406|  500|     600| 82|      88|     11.3|         31| 10932|       73|\n|   Allegheny College|    Yes|2652|  1900|   484|       44|       77|       1707|         44|   17080|      4440|  400|     600| 73|      91|      9.9|         41| 11711|       76|\n|Allentown Coll. o...|    Yes|1179|   780|   290|       38|       64|       1130|        638|    9690|      4785|  600|    1000| 60|      84|     13.3|         21|  7940|       74|\n|        Alma College|    Yes|1267|  1080|   385|       44|       73|       1306|         28|   12572|      4552|  400|     400| 79|      87|     15.3|         32|  9305|       68|\n|     Alverno College|    Yes| 494|   313|   157|       23|       46|       1317|       1235|    8352|      3640|  650|    2449| 36|      69|     11.1|         26|  8127|       55|\n|American Internat...|    Yes|1420|  1093|   220|        9|       22|       1018|        287|    8700|      4780|  450|    1400| 78|      84|     14.7|         19|  7355|       69|\n|     Amherst College|    Yes|4302|   992|   418|       83|       96|       1593|          5|   19760|      5300|  660|    1598| 93|      98|      8.4|         63| 21424|      100|\n| Anderson University|    Yes|1216|   908|   423|       19|       40|       1819|        281|   10100|      3520|  550|    1100| 48|      61|     12.1|         14|  7994|       59|\n|  Andrews University|    Yes|1130|   704|   322|       14|       23|       1586|        326|    9996|      3090|  900|    1320| 62|      66|     11.5|         18| 10908|       46|\n|Angelo State Univ...|     No|3540|  2001|  1016|       24|       54|       4190|       1512|    5130|      3592|  500|    2000| 60|      62|     23.1|          5|  4010|       34|\n+--------------------+-------+----+------+------+---------+---------+-----------+-----------+--------+----------+-----+--------+---+--------+---------+-----------+------+---------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766698581,"submitTime":1518766694427,"finishTime":1518766699266,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3d3dc755-43eb-4236-9ca0-33f45178b119"},{"version":"CommandV1","origId":2042983320593137,"guid":"b9cd031c-1593-44b2-b9ac-249e425abb86","subtype":"command","commandType":"auto","position":5.0,"command":"data.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- School: string (nullable = true)\n |-- Private: string (nullable = true)\n |-- Apps: integer (nullable = true)\n |-- Accept: integer (nullable = true)\n |-- Enroll: integer (nullable = true)\n |-- Top10perc: integer (nullable = true)\n |-- Top25perc: integer (nullable = true)\n |-- F_Undergrad: integer (nullable = true)\n |-- P_Undergrad: integer (nullable = true)\n |-- Outstate: integer (nullable = true)\n |-- Room_Board: integer (nullable = true)\n |-- Books: integer (nullable = true)\n |-- Personal: integer (nullable = true)\n |-- PhD: integer (nullable = true)\n |-- Terminal: integer (nullable = true)\n |-- S_F_Ratio: double (nullable = true)\n |-- perc_alumni: integer (nullable = true)\n |-- Expend: integer (nullable = true)\n |-- Grad_Rate: integer (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766699277,"submitTime":1518766695205,"finishTime":1518766699354,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b061fcf0-aeca-4a5e-a368-c7435a182b1b"},{"version":"CommandV1","origId":2042983320593138,"guid":"1d8a3baf-5f61-4a9b-a82c-3b7111ba7a86","subtype":"command","commandType":"auto","position":6.0,"command":"data.head(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">8</span><span class=\"ansired\">]: </span>[Row(School=u&apos;Abilene Christian University&apos;, Private=u&apos;Yes&apos;, Apps=1660, Accept=1232, Enroll=721, Top10perc=23, Top25perc=52, F_Undergrad=2885, P_Undergrad=537, Outstate=7440, Room_Board=3300, Books=450, Personal=2200, PhD=70, Terminal=78, S_F_Ratio=18.1, perc_alumni=12, Expend=7041, Grad_Rate=60)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766699367,"submitTime":1518766696259,"finishTime":1518766699748,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4b197ff2-c533-43a0-a630-55c3f27afeff"},{"version":"CommandV1","origId":2042983320593139,"guid":"f1170427-c897-4829-90c5-bd2de10b541f","subtype":"command","commandType":"auto","position":7.0,"command":"from pyspark.ml.feature import VectorAssembler","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766699760,"submitTime":1518766697741,"finishTime":1518766699836,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec268ff5-852f-46d8-b2a0-af02908586c3"},{"version":"CommandV1","origId":2042983320593140,"guid":"82d244c9-476b-498d-bb82-f01a160687b8","subtype":"command","commandType":"auto","position":8.0,"command":"data.columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>\n[&apos;School&apos;,\n &apos;Private&apos;,\n &apos;Apps&apos;,\n &apos;Accept&apos;,\n &apos;Enroll&apos;,\n &apos;Top10perc&apos;,\n &apos;Top25perc&apos;,\n &apos;F_Undergrad&apos;,\n &apos;P_Undergrad&apos;,\n &apos;Outstate&apos;,\n &apos;Room_Board&apos;,\n &apos;Books&apos;,\n &apos;Personal&apos;,\n &apos;PhD&apos;,\n &apos;Terminal&apos;,\n &apos;S_F_Ratio&apos;,\n &apos;perc_alumni&apos;,\n &apos;Expend&apos;,\n &apos;Grad_Rate&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766708825,"submitTime":1518766708805,"finishTime":1518766708853,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9280186-6abb-4630-aeef-65f665049b38"},{"version":"CommandV1","origId":2042983320593141,"guid":"aac3d297-e6b6-450d-9f04-b3d4f4e34942","subtype":"command","commandType":"auto","position":9.0,"command":"assembler = VectorAssembler(inputCols=['Apps',\n 'Accept',\n 'Enroll',\n 'Top10perc',\n 'Top25perc',\n 'F_Undergrad',\n 'P_Undergrad',\n 'Outstate',\n 'Room_Board',\n 'Books',\n 'Personal',\n 'PhD',\n 'Terminal',\n 'S_F_Ratio',\n 'perc_alumni',\n 'Expend',\n 'Grad_Rate'], outputCol='features')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766711237,"submitTime":1518766711218,"finishTime":1518766711362,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cb4d7cb7-1af4-4c46-8f29-29bca6f93f93"},{"version":"CommandV1","origId":2042983320593142,"guid":"a5c82cf9-7a5b-4e68-a1cc-72466d884f19","subtype":"command","commandType":"auto","position":10.0,"command":"output = assembler.transform(data)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"output","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"School","nullable":true,"type":"string"},{"metadata":{},"name":"Private","nullable":true,"type":"string"},{"metadata":{},"name":"Apps","nullable":true,"type":"integer"},{"metadata":{},"name":"Accept","nullable":true,"type":"integer"},{"metadata":{},"name":"Enroll","nullable":true,"type":"integer"},{"metadata":{},"name":"Top10perc","nullable":true,"type":"integer"},{"metadata":{},"name":"Top25perc","nullable":true,"type":"integer"},{"metadata":{},"name":"F_Undergrad","nullable":true,"type":"integer"},{"metadata":{},"name":"P_Undergrad","nullable":true,"type":"integer"},{"metadata":{},"name":"Outstate","nullable":true,"type":"integer"},{"metadata":{},"name":"Room_Board","nullable":true,"type":"integer"},{"metadata":{},"name":"Books","nullable":true,"type":"integer"},{"metadata":{},"name":"Personal","nullable":true,"type":"integer"},{"metadata":{},"name":"PhD","nullable":true,"type":"integer"},{"metadata":{},"name":"Terminal","nullable":true,"type":"integer"},{"metadata":{},"name":"S_F_Ratio","nullable":true,"type":"double"},{"metadata":{},"name":"perc_alumni","nullable":true,"type":"integer"},{"metadata":{},"name":"Expend","nullable":true,"type":"integer"},{"metadata":{},"name":"Grad_Rate","nullable":true,"type":"integer"},{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Data type StringType is not supported.&apos;","error":null,"workflows":[],"startTime":1518766714735,"submitTime":1518766714716,"finishTime":1518766715123,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"39c33a4e-d466-40ac-9250-a74f0c563ae3"},{"version":"CommandV1","origId":2042983320593143,"guid":"e03ddc05-d33c-46f0-aac1-7197b27ffef9","subtype":"command","commandType":"auto","position":11.0,"command":"from pyspark.ml.feature import StringIndexer","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766715356,"submitTime":1518766715337,"finishTime":1518766715431,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3b9da11-ea74-487a-a744-c4b40ecb1f89"},{"version":"CommandV1","origId":2042983320593144,"guid":"36bfe6b8-0341-48f0-968f-52f6c295687f","subtype":"command","commandType":"auto","position":12.0,"command":"indexer = StringIndexer(inputCol='Private', outputCol='PrivateIndex')\n","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;StringIndexer&apos; object has no attribute &apos;show&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2042983320593144&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> indexer <span class=\"ansiyellow\">=</span> StringIndexer<span class=\"ansiyellow\">(</span>inputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;Private&apos;</span><span class=\"ansiyellow\">,</span> outputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;PrivateIndex&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>indexer<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;StringIndexer&apos; object has no attribute &apos;show&apos;</div>","workflows":[],"startTime":1518766979653,"submitTime":1518766979653,"finishTime":1518766979751,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"72f8dcb5-f37e-4c99-b2b0-e3a30ce0c028"},{"version":"CommandV1","origId":2042983320593145,"guid":"d2ceb688-8d8f-4d40-8c11-53f393d43e94","subtype":"command","commandType":"auto","position":13.0,"command":"output_fixed = indexer.fit(output).transform(output)\noutput_fixed.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+-------+----+------+------+---------+---------+-----------+-----------+--------+----------+-----+--------+---+--------+---------+-----------+------+---------+--------------------+------------+\n|              School|Private|Apps|Accept|Enroll|Top10perc|Top25perc|F_Undergrad|P_Undergrad|Outstate|Room_Board|Books|Personal|PhD|Terminal|S_F_Ratio|perc_alumni|Expend|Grad_Rate|            features|PrivateIndex|\n+--------------------+-------+----+------+------+---------+---------+-----------+-----------+--------+----------+-----+--------+---+--------+---------+-----------+------+---------+--------------------+------------+\n|Abilene Christian...|    Yes|1660|  1232|   721|       23|       52|       2885|        537|    7440|      3300|  450|    2200| 70|      78|     18.1|         12|  7041|       60|[1660.0,1232.0,72...|         0.0|\n|  Adelphi University|    Yes|2186|  1924|   512|       16|       29|       2683|       1227|   12280|      6450|  750|    1500| 29|      30|     12.2|         16| 10527|       56|[2186.0,1924.0,51...|         0.0|\n|      Adrian College|    Yes|1428|  1097|   336|       22|       50|       1036|         99|   11250|      3750|  400|    1165| 53|      66|     12.9|         30|  8735|       54|[1428.0,1097.0,33...|         0.0|\n| Agnes Scott College|    Yes| 417|   349|   137|       60|       89|        510|         63|   12960|      5450|  450|     875| 92|      97|      7.7|         37| 19016|       59|[417.0,349.0,137....|         0.0|\n|Alaska Pacific Un...|    Yes| 193|   146|    55|       16|       44|        249|        869|    7560|      4120|  800|    1500| 76|      72|     11.9|          2| 10922|       15|[193.0,146.0,55.0...|         0.0|\n|   Albertson College|    Yes| 587|   479|   158|       38|       62|        678|         41|   13500|      3335|  500|     675| 67|      73|      9.4|         11|  9727|       55|[587.0,479.0,158....|         0.0|\n|Albertus Magnus C...|    Yes| 353|   340|   103|       17|       45|        416|        230|   13290|      5720|  500|    1500| 90|      93|     11.5|         26|  8861|       63|[353.0,340.0,103....|         0.0|\n|      Albion College|    Yes|1899|  1720|   489|       37|       68|       1594|         32|   13868|      4826|  450|     850| 89|     100|     13.7|         37| 11487|       73|[1899.0,1720.0,48...|         0.0|\n|    Albright College|    Yes|1038|   839|   227|       30|       63|        973|        306|   15595|      4400|  300|     500| 79|      84|     11.3|         23| 11644|       80|[1038.0,839.0,227...|         0.0|\n|Alderson-Broaddus...|    Yes| 582|   498|   172|       21|       44|        799|         78|   10468|      3380|  660|    1800| 40|      41|     11.5|         15|  8991|       52|[582.0,498.0,172....|         0.0|\n|   Alfred University|    Yes|1732|  1425|   472|       37|       75|       1830|        110|   16548|      5406|  500|     600| 82|      88|     11.3|         31| 10932|       73|[1732.0,1425.0,47...|         0.0|\n|   Allegheny College|    Yes|2652|  1900|   484|       44|       77|       1707|         44|   17080|      4440|  400|     600| 73|      91|      9.9|         41| 11711|       76|[2652.0,1900.0,48...|         0.0|\n|Allentown Coll. o...|    Yes|1179|   780|   290|       38|       64|       1130|        638|    9690|      4785|  600|    1000| 60|      84|     13.3|         21|  7940|       74|[1179.0,780.0,290...|         0.0|\n|        Alma College|    Yes|1267|  1080|   385|       44|       73|       1306|         28|   12572|      4552|  400|     400| 79|      87|     15.3|         32|  9305|       68|[1267.0,1080.0,38...|         0.0|\n|     Alverno College|    Yes| 494|   313|   157|       23|       46|       1317|       1235|    8352|      3640|  650|    2449| 36|      69|     11.1|         26|  8127|       55|[494.0,313.0,157....|         0.0|\n|American Internat...|    Yes|1420|  1093|   220|        9|       22|       1018|        287|    8700|      4780|  450|    1400| 78|      84|     14.7|         19|  7355|       69|[1420.0,1093.0,22...|         0.0|\n|     Amherst College|    Yes|4302|   992|   418|       83|       96|       1593|          5|   19760|      5300|  660|    1598| 93|      98|      8.4|         63| 21424|      100|[4302.0,992.0,418...|         0.0|\n| Anderson University|    Yes|1216|   908|   423|       19|       40|       1819|        281|   10100|      3520|  550|    1100| 48|      61|     12.1|         14|  7994|       59|[1216.0,908.0,423...|         0.0|\n|  Andrews University|    Yes|1130|   704|   322|       14|       23|       1586|        326|    9996|      3090|  900|    1320| 62|      66|     11.5|         18| 10908|       46|[1130.0,704.0,322...|         0.0|\n|Angelo State Univ...|     No|3540|  2001|  1016|       24|       54|       4190|       1512|    5130|      3592|  500|    2000| 60|      62|     23.1|          5|  4010|       34|[3540.0,2001.0,10...|         1.0|\n+--------------------+-------+----+------+------+---------+---------+-----------+-----------+--------+----------+-----+--------+---+--------+---------+-----------+------+---------+--------------------+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"output_fixed","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"School","nullable":true,"type":"string"},{"metadata":{},"name":"Private","nullable":true,"type":"string"},{"metadata":{},"name":"Apps","nullable":true,"type":"integer"},{"metadata":{},"name":"Accept","nullable":true,"type":"integer"},{"metadata":{},"name":"Enroll","nullable":true,"type":"integer"},{"metadata":{},"name":"Top10perc","nullable":true,"type":"integer"},{"metadata":{},"name":"Top25perc","nullable":true,"type":"integer"},{"metadata":{},"name":"F_Undergrad","nullable":true,"type":"integer"},{"metadata":{},"name":"P_Undergrad","nullable":true,"type":"integer"},{"metadata":{},"name":"Outstate","nullable":true,"type":"integer"},{"metadata":{},"name":"Room_Board","nullable":true,"type":"integer"},{"metadata":{},"name":"Books","nullable":true,"type":"integer"},{"metadata":{},"name":"Personal","nullable":true,"type":"integer"},{"metadata":{},"name":"PhD","nullable":true,"type":"integer"},{"metadata":{},"name":"Terminal","nullable":true,"type":"integer"},{"metadata":{},"name":"S_F_Ratio","nullable":true,"type":"double"},{"metadata":{},"name":"perc_alumni","nullable":true,"type":"integer"},{"metadata":{},"name":"Expend","nullable":true,"type":"integer"},{"metadata":{},"name":"Grad_Rate","nullable":true,"type":"integer"},{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"PrivateIndex","type":"nominal","vals":["Yes","No"]}},"name":"PrivateIndex","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767019998,"submitTime":1518767019981,"finishTime":1518767020852,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"397a7e4b-406b-4ef5-8f3c-4b2a13fa39e3"},{"version":"CommandV1","origId":2042983320593146,"guid":"db9c5fd6-928c-4ea6-af02-655b9dd32edb","subtype":"command","commandType":"auto","position":14.0,"command":"output_fixed.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- School: string (nullable = true)\n |-- Private: string (nullable = true)\n |-- Apps: integer (nullable = true)\n |-- Accept: integer (nullable = true)\n |-- Enroll: integer (nullable = true)\n |-- Top10perc: integer (nullable = true)\n |-- Top25perc: integer (nullable = true)\n |-- F_Undergrad: integer (nullable = true)\n |-- P_Undergrad: integer (nullable = true)\n |-- Outstate: integer (nullable = true)\n |-- Room_Board: integer (nullable = true)\n |-- Books: integer (nullable = true)\n |-- Personal: integer (nullable = true)\n |-- PhD: integer (nullable = true)\n |-- Terminal: integer (nullable = true)\n |-- S_F_Ratio: double (nullable = true)\n |-- perc_alumni: integer (nullable = true)\n |-- Expend: integer (nullable = true)\n |-- Grad_Rate: integer (nullable = true)\n |-- features: vector (nullable = true)\n |-- PrivateIndex: double (nullable = false)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766718781,"submitTime":1518766718229,"finishTime":1518766718858,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c0e6c79-d515-491d-b04c-0b1a0b3ff489"},{"version":"CommandV1","origId":2042983320593147,"guid":"9361ccfa-a54b-443f-8b95-8448e93ba513","subtype":"command","commandType":"auto","position":15.0,"command":"final_data = output_fixed.select(\"features\",\"PrivateIndex\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"final_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"PrivateIndex","type":"nominal","vals":["Yes","No"]}},"name":"PrivateIndex","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766718870,"submitTime":1518766718798,"finishTime":1518766718947,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"44f4a50b-fd40-4730-9053-d7bdf478d17a"},{"version":"CommandV1","origId":2042983320593148,"guid":"23b1f716-c893-4f40-924f-6ad418e4642f","subtype":"command","commandType":"auto","position":16.0,"command":"train_data, test_data = final_data.randomSplit([.7, .3])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"PrivateIndex","type":"nominal","vals":["Yes","No"]}},"name":"PrivateIndex","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"test_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"PrivateIndex","type":"nominal","vals":["Yes","No"]}},"name":"PrivateIndex","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766723358,"submitTime":1518766723338,"finishTime":1518766723436,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b0bab8af-a5f6-496f-86bc-a590cf9b2e50"},{"version":"CommandV1","origId":2042983320593149,"guid":"6ad9b3e2-12fc-4d8b-aedc-490724bc4ce4","subtype":"command","commandType":"auto","position":17.0,"command":"from pyspark.ml.classification import (DecisionTreeClassifier, GBTClassifier, RandomForestClassifier)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766734856,"submitTime":1518766734837,"finishTime":1518766734931,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7cbec275-1220-41ff-a58c-f80ea6ba6e7d"},{"version":"CommandV1","origId":2042983320593150,"guid":"1f8c0eed-c1a0-4d7b-8faf-312182c4ee79","subtype":"command","commandType":"auto","position":18.0,"command":"from pyspark.ml.regression import RandomForestRegressor","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766737128,"submitTime":1518766737110,"finishTime":1518766737203,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d9e5cfc2-40a8-4d8e-997b-f1d1cc896f2a"},{"version":"CommandV1","origId":2042983320593151,"guid":"7df78067-53b3-4360-baaa-eb6757340ae5","subtype":"command","commandType":"auto","position":19.0,"command":"from pyspark.ml import Pipeline","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766739175,"submitTime":1518766739155,"finishTime":1518766739201,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1ac5e203-2818-497f-88d2-84d1491cd046"},{"version":"CommandV1","origId":2042983320593152,"guid":"464cbe28-3061-4d8a-b11d-ce55c1e1ed9d","subtype":"command","commandType":"auto","position":20.0,"command":"dtc = DecisionTreeClassifier(labelCol='PrivateIndex',featuresCol='features')\nrfc = RandomForestClassifier(numTrees=150,labelCol='PrivateIndex',featuresCol='features')\ngbt = GBTClassifier(labelCol='PrivateIndex',featuresCol='features')\n                             \n                         ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766741640,"submitTime":1518766741622,"finishTime":1518766741773,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"618640f3-2f1c-406f-9b75-50654f395dbc"},{"version":"CommandV1","origId":2042983320593153,"guid":"55b4146d-d33a-4e34-8e6e-2807ad749aef","subtype":"command","commandType":"auto","position":21.0,"command":"dtc_model = dtc.fit(train_data)\nrfc_model = rfc.fit(train_data)\ngbt_model = gbt.fit(train_data)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;PirvateIndex&quot; does not exist.&apos;","error":null,"workflows":[],"startTime":1518766744068,"submitTime":1518766744050,"finishTime":1518766765736,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ad97452d-83d7-4116-b924-4983cd20c526"},{"version":"CommandV1","origId":2042983320593154,"guid":"e6cbf77e-77b4-4600-ba5d-8ffb6cd384c2","subtype":"command","commandType":"auto","position":22.0,"command":"dtc_preds = dtc_model.transform(test_data)\nrfc_preds = rfc_model.transform(test_data)\ngbt_preds = gbt_model.transform(test_data)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"dtc_preds","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"PrivateIndex","type":"nominal","vals":["Yes","No"]}},"name":"PrivateIndex","nullable":false,"type":"double"},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"rfc_preds","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"PrivateIndex","type":"nominal","vals":["Yes","No"]}},"name":"PrivateIndex","nullable":false,"type":"double"},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"gbt_preds","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"Apps"},{"idx":1,"name":"Accept"},{"idx":2,"name":"Enroll"},{"idx":3,"name":"Top10perc"},{"idx":4,"name":"Top25perc"},{"idx":5,"name":"F_Undergrad"},{"idx":6,"name":"P_Undergrad"},{"idx":7,"name":"Outstate"},{"idx":8,"name":"Room_Board"},{"idx":9,"name":"Books"},{"idx":10,"name":"Personal"},{"idx":11,"name":"PhD"},{"idx":12,"name":"Terminal"},{"idx":13,"name":"S_F_Ratio"},{"idx":14,"name":"perc_alumni"},{"idx":15,"name":"Expend"},{"idx":16,"name":"Grad_Rate"}]},"num_attrs":17}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"PrivateIndex","type":"nominal","vals":["Yes","No"]}},"name":"PrivateIndex","nullable":false,"type":"double"},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;GBTClassifier&apos; object has no attribute &apos;transform&apos;","error":null,"workflows":[],"startTime":1518766765747,"submitTime":1518766756133,"finishTime":1518766766034,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"59e0f057-2505-4516-8755-f3791ca94fbd"},{"version":"CommandV1","origId":2042983320593155,"guid":"877517a7-f3af-4bd1-9e14-f18fa3f021c4","subtype":"command","commandType":"auto","position":23.0,"command":"from pyspark.ml.evaluation import BinaryClassificationEvaluator","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">ImportError</span>: cannot import name BinaruClassificationEvaluator","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ImportError</span>                               Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2042983320593155&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>ml<span class=\"ansiyellow\">.</span>evaluation <span class=\"ansigreen\">import</span> BinaruClassificationEvaluator<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ImportError</span>: cannot import name BinaruClassificationEvaluator</div>","workflows":[],"startTime":1518766769174,"submitTime":1518766769155,"finishTime":1518766769249,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d1fa5e9a-9eab-4303-96f1-461de756b4c1"},{"version":"CommandV1","origId":2577459170412534,"guid":"d0df0605-e721-4c06-a881-f52e9f993424","subtype":"command","commandType":"auto","position":24.0,"command":"my_binary_eval = BinaryClassificationEvaluator(labelCol='PrivateIndex')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766778207,"submitTime":1518766778185,"finishTime":1518766778280,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4b016038-e99b-49fa-990f-642d1ef6b44f"},{"version":"CommandV1","origId":2577459170412535,"guid":"b1d62416-9cd7-41ea-8a5c-3856af4d4619","subtype":"command","commandType":"auto","position":25.0,"command":"print('DTC')\nprint(my_binary_eval.evaluate(dtc_preds))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DTC\n0.917248603352\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518766805457,"submitTime":1518766805438,"finishTime":1518766806136,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c5fbfbaa-7cb0-4e55-a4cb-db985f660984"},{"version":"CommandV1","origId":2577459170412536,"guid":"4f7b0fa4-6466-4e2b-94b2-4e92acbdc37d","subtype":"command","commandType":"auto","position":26.0,"command":"print(\"RFC\")\nprint(my_binary_eval.evaluate(rfc_preds))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">RFC\n0.969230097765\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767132546,"submitTime":1518767132527,"finishTime":1518767133327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d45524c-51b3-4e33-931b-c198ff014c2b"},{"version":"CommandV1","origId":2577459170412537,"guid":"30b68e69-8c26-44b2-9eac-e7cfd6b73010","subtype":"command","commandType":"auto","position":27.0,"command":"gbt_preds.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- features: vector (nullable = true)\n |-- PrivateIndex: double (nullable = false)\n |-- rawPrediction: vector (nullable = true)\n |-- probability: vector (nullable = true)\n |-- prediction: double (nullable = false)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767170490,"submitTime":1518767170471,"finishTime":1518767170517,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e38e5903-025f-44a7-aac5-341a945b0e06"},{"version":"CommandV1","origId":2577459170412538,"guid":"a543c0bb-a5db-417c-be29-e701aaf5e41e","subtype":"command","commandType":"auto","position":28.0,"command":"rfc_preds.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- features: vector (nullable = true)\n |-- PrivateIndex: double (nullable = false)\n |-- rawPrediction: vector (nullable = true)\n |-- probability: vector (nullable = true)\n |-- prediction: double (nullable = false)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767231742,"submitTime":1518767231722,"finishTime":1518767231817,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c48c9cdd-4712-4606-aa79-b0a74e9fd185"},{"version":"CommandV1","origId":2577459170412539,"guid":"533009a3-da06-425a-b44b-a4ca8ec8ba98","subtype":"command","commandType":"auto","position":29.0,"command":"from pyspark.ml.evaluation import MulticlassClassificationEvaluator","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767747225,"submitTime":1518767747205,"finishTime":1518767747267,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb3a54e5-ad32-4ebe-87f6-b92d5fbc53c8"},{"version":"CommandV1","origId":2577459170412540,"guid":"50251692-5ee8-49e4-ae06-5d61f1368e05","subtype":"command","commandType":"auto","position":26.5,"command":"my_binary_eval2 = BinaryClassificationEvaluator(labelCol='PrivateIndex',\n                                               rawPredictionCol='prediction')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767414095,"submitTime":1518767414077,"finishTime":1518767414170,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9efd02d-864f-4083-b3a7-fbfc06f3a004"},{"version":"CommandV1","origId":2577459170412541,"guid":"c910b3f3-f22c-4c2c-a73c-1940763967a5","subtype":"command","commandType":"auto","position":26.75,"command":"print(\"GBT\")\nprint(my_binary_eval2.evaluate(gbt_preds))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">GBT\n0.859898743017\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;GBTClassifier&apos; object has no attribute &apos;_jdf&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2577459170412541&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;GBT&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span>my_binary_eval2<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>gbt<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">evaluate</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     67</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">_evaluate</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">     97</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">     98</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 99</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    100</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    101</span>     <span class=\"ansigreen\">def</span> isLargerBetter<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;GBTClassifier&apos; object has no attribute &apos;_jdf&apos;</div>","workflows":[],"startTime":1518767478348,"submitTime":1518767478332,"finishTime":1518767479029,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cad9b0b1-270e-4bf9-b489-f76b5f639b23"},{"version":"CommandV1","origId":2577459170412542,"guid":"85527cd2-7dce-46f9-882d-cc70ace8e53d","subtype":"command","commandType":"auto","position":30.0,"command":"acc_eval = MulticlassClassificationEvaluator(labelCol='PrivateIndex', \n                                             metricName='accuracy')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767833754,"submitTime":1518767833742,"finishTime":1518767833829,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2ab43de4-7222-4ca4-bbb5-b400300113fc"},{"version":"CommandV1","origId":2577459170412543,"guid":"cbe13f77-13af-4d43-a95c-8fdec2aae693","subtype":"command","commandType":"auto","position":31.0,"command":"rfc_acc = acc_eval.evaluate(rfc_preds)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767867138,"submitTime":1518767867119,"finishTime":1518767867919,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2efbce13-c1d3-403c-9fb5-1496b55ab0d0"},{"version":"CommandV1","origId":2577459170412544,"guid":"2ff9d891-3d6a-4ad1-ad65-ffbe9d760432","subtype":"command","commandType":"auto","position":32.0,"command":"rfc_acc","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">45</span><span class=\"ansired\">]: </span>0.9300411522633745\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1518767870634,"submitTime":1518767870615,"finishTime":1518767870708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jrandson@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bd03d53d-7d57-4c14-bd40-59cda0587b4a"},{"version":"CommandV1","origId":2577459170412545,"guid":"e26dbf8d-8123-4b46-b113-87fb2ff41e52","subtype":"command","commandType":"auto","position":33.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"11781f81-f2da-49fb-97a6-37f2e4742976"}],"dashboards":[],"guid":"c719009f-ce99-4bf7-aec1-889e57faaceb","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}